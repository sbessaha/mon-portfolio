{"ast":null,"code":"import { createVNode as _createVNode, mergeProps as _mergeProps, resolveDirective as _resolveDirective } from \"vue\"; // Utilities\n\nimport { Transition } from 'vue';\nimport { acceleratedEasing, animate, deceleratedEasing, genericComponent, nullifyTransforms, propsFactory, standardEasing } from \"../../util/index.mjs\";\nimport { getTargetBox } from \"../../util/box.mjs\"; // Types\n\nexport const makeVDialogTransitionProps = propsFactory({\n  target: [Object, Array]\n}, 'v-dialog-transition');\nexport const VDialogTransition = genericComponent()({\n  name: 'VDialogTransition',\n  props: makeVDialogTransitionProps(),\n\n  setup(props, _ref) {\n    let {\n      slots\n    } = _ref;\n    const functions = {\n      onBeforeEnter(el) {\n        el.style.pointerEvents = 'none';\n        el.style.visibility = 'hidden';\n      },\n\n      async onEnter(el, done) {\n        await new Promise(resolve => requestAnimationFrame(resolve));\n        await new Promise(resolve => requestAnimationFrame(resolve));\n        el.style.visibility = '';\n        const {\n          x,\n          y,\n          sx,\n          sy,\n          speed\n        } = getDimensions(props.target, el);\n        const animation = animate(el, [{\n          transform: `translate(${x}px, ${y}px) scale(${sx}, ${sy})`,\n          opacity: 0\n        }, {}], {\n          duration: 225 * speed,\n          easing: deceleratedEasing\n        });\n        getChildren(el)?.forEach(el => {\n          animate(el, [{\n            opacity: 0\n          }, {\n            opacity: 0,\n            offset: 0.33\n          }, {}], {\n            duration: 225 * 2 * speed,\n            easing: standardEasing\n          });\n        });\n        animation.finished.then(() => done());\n      },\n\n      onAfterEnter(el) {\n        el.style.removeProperty('pointer-events');\n      },\n\n      onBeforeLeave(el) {\n        el.style.pointerEvents = 'none';\n      },\n\n      async onLeave(el, done) {\n        await new Promise(resolve => requestAnimationFrame(resolve));\n        const {\n          x,\n          y,\n          sx,\n          sy,\n          speed\n        } = getDimensions(props.target, el);\n        const animation = animate(el, [{}, {\n          transform: `translate(${x}px, ${y}px) scale(${sx}, ${sy})`,\n          opacity: 0\n        }], {\n          duration: 125 * speed,\n          easing: acceleratedEasing\n        });\n        animation.finished.then(() => done());\n        getChildren(el)?.forEach(el => {\n          animate(el, [{}, {\n            opacity: 0,\n            offset: 0.2\n          }, {\n            opacity: 0\n          }], {\n            duration: 125 * 2 * speed,\n            easing: standardEasing\n          });\n        });\n      },\n\n      onAfterLeave(el) {\n        el.style.removeProperty('pointer-events');\n      }\n\n    };\n    return () => {\n      return props.target ? _createVNode(Transition, _mergeProps({\n        \"name\": \"dialog-transition\"\n      }, functions, {\n        \"css\": false\n      }), slots) : _createVNode(Transition, {\n        \"name\": \"dialog-transition\"\n      }, slots);\n    };\n  }\n\n});\n/** Animatable children (card, sheet, list) */\n\nfunction getChildren(el) {\n  const els = el.querySelector(':scope > .v-card, :scope > .v-sheet, :scope > .v-list')?.children;\n  return els && [...els];\n}\n\nfunction getDimensions(target, el) {\n  const targetBox = getTargetBox(target);\n  const elBox = nullifyTransforms(el);\n  const [originX, originY] = getComputedStyle(el).transformOrigin.split(' ').map(v => parseFloat(v));\n  const [anchorSide, anchorOffset] = getComputedStyle(el).getPropertyValue('--v-overlay-anchor-origin').split(' ');\n  let offsetX = targetBox.left + targetBox.width / 2;\n\n  if (anchorSide === 'left' || anchorOffset === 'left') {\n    offsetX -= targetBox.width / 2;\n  } else if (anchorSide === 'right' || anchorOffset === 'right') {\n    offsetX += targetBox.width / 2;\n  }\n\n  let offsetY = targetBox.top + targetBox.height / 2;\n\n  if (anchorSide === 'top' || anchorOffset === 'top') {\n    offsetY -= targetBox.height / 2;\n  } else if (anchorSide === 'bottom' || anchorOffset === 'bottom') {\n    offsetY += targetBox.height / 2;\n  }\n\n  const tsx = targetBox.width / elBox.width;\n  const tsy = targetBox.height / elBox.height;\n  const maxs = Math.max(1, tsx, tsy);\n  const sx = tsx / maxs || 0;\n  const sy = tsy / maxs || 0; // Animate elements larger than 12% of the screen area up to 1.5x slower\n\n  const asa = elBox.width * elBox.height / (window.innerWidth * window.innerHeight);\n  const speed = asa > 0.12 ? Math.min(1.5, (asa - 0.12) * 10 + 1) : 1;\n  return {\n    x: offsetX - (originX + elBox.left),\n    y: offsetY - (originY + elBox.top),\n    sx,\n    sy,\n    speed\n  };\n}","map":{"version":3,"mappings":"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","names":["Transition","acceleratedEasing","animate","deceleratedEasing","genericComponent","nullifyTransforms","propsFactory","standardEasing","getTargetBox","makeVDialogTransitionProps","target","Object","Array","VDialogTransition","name","props","setup","_ref","slots","functions","onBeforeEnter","el","style","pointerEvents","visibility","onEnter","done","Promise","resolve","requestAnimationFrame","x","y","sx","sy","speed","getDimensions","animation","transform","opacity","duration","easing","getChildren","forEach","offset","finished","then","onAfterEnter","removeProperty","onBeforeLeave","onLeave","onAfterLeave","_createVNode","els","querySelector","children","targetBox","elBox","originX","originY","getComputedStyle","transformOrigin","split","map","v","parseFloat","anchorSide","anchorOffset","getPropertyValue","offsetX","left","width","offsetY","top","height","tsx","tsy","maxs","Math","max","asa","window","innerWidth","innerHeight","min"],"sources":["../../../src/components/transitions/dialog-transition.tsx"],"sourcesContent":["// Utilities\nimport { Transition } from 'vue'\nimport {\n  acceleratedEasing,\n  animate,\n  deceleratedEasing,\n  genericComponent,\n  nullifyTransforms,\n  propsFactory,\n  standardEasing,\n} from '@/util'\nimport { getTargetBox } from '@/util/box'\n\n// Types\nimport type { PropType } from 'vue'\n\nexport const makeVDialogTransitionProps = propsFactory({\n  target: [Object, Array] as PropType<HTMLElement | [x: number, y: number]>,\n}, 'v-dialog-transition')\n\nexport const VDialogTransition = genericComponent()({\n  name: 'VDialogTransition',\n\n  props: makeVDialogTransitionProps(),\n\n  setup (props, { slots }) {\n    const functions = {\n      onBeforeEnter (el: Element) {\n        (el as HTMLElement).style.pointerEvents = 'none'\n        ;(el as HTMLElement).style.visibility = 'hidden'\n      },\n      async onEnter (el: Element, done: () => void) {\n        await new Promise(resolve => requestAnimationFrame(resolve))\n        await new Promise(resolve => requestAnimationFrame(resolve))\n        ;(el as HTMLElement).style.visibility = ''\n\n        const { x, y, sx, sy, speed } = getDimensions(props.target!, el as HTMLElement)\n\n        const animation = animate(el, [\n          { transform: `translate(${x}px, ${y}px) scale(${sx}, ${sy})`, opacity: 0 },\n          {},\n        ], {\n          duration: 225 * speed,\n          easing: deceleratedEasing,\n        })\n        getChildren(el)?.forEach(el => {\n          animate(el, [\n            { opacity: 0 },\n            { opacity: 0, offset: 0.33 },\n            {},\n          ], {\n            duration: 225 * 2 * speed,\n            easing: standardEasing,\n          })\n        })\n        animation.finished.then(() => done())\n      },\n      onAfterEnter (el: Element) {\n        (el as HTMLElement).style.removeProperty('pointer-events')\n      },\n      onBeforeLeave (el: Element) {\n        (el as HTMLElement).style.pointerEvents = 'none'\n      },\n      async onLeave (el: Element, done: () => void) {\n        await new Promise(resolve => requestAnimationFrame(resolve))\n\n        const { x, y, sx, sy, speed } = getDimensions(props.target!, el as HTMLElement)\n\n        const animation = animate(el, [\n          {},\n          { transform: `translate(${x}px, ${y}px) scale(${sx}, ${sy})`, opacity: 0 },\n        ], {\n          duration: 125 * speed,\n          easing: acceleratedEasing,\n        })\n        animation.finished.then(() => done())\n        getChildren(el)?.forEach(el => {\n          animate(el, [\n            {},\n            { opacity: 0, offset: 0.2 },\n            { opacity: 0 },\n          ], {\n            duration: 125 * 2 * speed,\n            easing: standardEasing,\n          })\n        })\n      },\n      onAfterLeave (el: Element) {\n        (el as HTMLElement).style.removeProperty('pointer-events')\n      },\n    }\n\n    return () => {\n      return props.target\n        ? (\n          <Transition\n            name=\"dialog-transition\"\n            { ...functions }\n            css={ false }\n            v-slots={ slots }\n          />\n        )\n        : <Transition name=\"dialog-transition\" v-slots={ slots } />\n    }\n  },\n})\n\n/** Animatable children (card, sheet, list) */\nfunction getChildren (el: Element) {\n  const els = el.querySelector(':scope > .v-card, :scope > .v-sheet, :scope > .v-list')?.children\n  return els && [...els]\n}\n\nfunction getDimensions (target: HTMLElement | [x: number, y: number], el: HTMLElement) {\n  const targetBox = getTargetBox(target)\n  const elBox = nullifyTransforms(el)\n  const [originX, originY] = getComputedStyle(el).transformOrigin.split(' ').map(v => parseFloat(v))\n\n  const [anchorSide, anchorOffset] = getComputedStyle(el).getPropertyValue('--v-overlay-anchor-origin').split(' ')\n\n  let offsetX = targetBox.left + targetBox.width / 2\n  if (anchorSide === 'left' || anchorOffset === 'left') {\n    offsetX -= targetBox.width / 2\n  } else if (anchorSide === 'right' || anchorOffset === 'right') {\n    offsetX += targetBox.width / 2\n  }\n\n  let offsetY = targetBox.top + targetBox.height / 2\n  if (anchorSide === 'top' || anchorOffset === 'top') {\n    offsetY -= targetBox.height / 2\n  } else if (anchorSide === 'bottom' || anchorOffset === 'bottom') {\n    offsetY += targetBox.height / 2\n  }\n\n  const tsx = targetBox.width / elBox.width\n  const tsy = targetBox.height / elBox.height\n  const maxs = Math.max(1, tsx, tsy)\n  const sx = tsx / maxs || 0\n  const sy = tsy / maxs || 0\n\n  // Animate elements larger than 12% of the screen area up to 1.5x slower\n  const asa = (elBox.width * elBox.height) / (window.innerWidth * window.innerHeight)\n  const speed = asa > 0.12\n    ? Math.min(1.5, (asa - 0.12) * 10 + 1)\n    : 1\n\n  return {\n    x: offsetX - (originX + elBox.left),\n    y: offsetY - (originY + elBox.top),\n    sx,\n    sy,\n    speed,\n  }\n}\n\nexport type VDialogTransition = InstanceType<typeof VDialogTransition>\n"]},"metadata":{},"sourceType":"module"}