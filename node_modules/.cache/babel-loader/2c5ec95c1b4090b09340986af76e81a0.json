{"ast":null,"code":"// Utilities\nimport { eventName, isOn } from \"./helpers.mjs\";\nconst handlers = new WeakMap();\nexport function bindProps(el, props) {\n  Object.keys(props).forEach(k => {\n    if (isOn(k)) {\n      const name = eventName(k);\n      const handler = handlers.get(el);\n\n      if (props[k] == null) {\n        handler?.forEach(v => {\n          const [n, fn] = v;\n\n          if (n === name) {\n            el.removeEventListener(name, fn);\n            handler.delete(v);\n          }\n        });\n      } else if (!handler || ![...handler]?.some(v => v[0] === name && v[1] === props[k])) {\n        el.addEventListener(name, props[k]);\n\n        const _handler = handler || new Set();\n\n        _handler.add([name, props[k]]);\n\n        if (!handlers.has(el)) handlers.set(el, _handler);\n      }\n    } else {\n      if (props[k] == null) {\n        el.removeAttribute(k);\n      } else {\n        el.setAttribute(k, props[k]);\n      }\n    }\n  });\n}\nexport function unbindProps(el, props) {\n  Object.keys(props).forEach(k => {\n    if (isOn(k)) {\n      const name = eventName(k);\n      const handler = handlers.get(el);\n      handler?.forEach(v => {\n        const [n, fn] = v;\n\n        if (n === name) {\n          el.removeEventListener(name, fn);\n          handler.delete(v);\n        }\n      });\n    } else {\n      el.removeAttribute(k);\n    }\n  });\n}","map":{"version":3,"mappings":"AAAA;AAAA,SACSA,SADT,EACoBC,IADpB,QACwB,eADxB;AAGA,MAAMC,QAAQ,GAAG,IAAIC,OAAJ,EAAjB;AAEA,OAAO,SAASC,SAAT,CAAoBC,EAApB,EAAqCC,KAArC,EAAiE;EACtEC,MAAM,CAACC,IAAPD,CAAYD,KAAZC,EAAmBE,OAAnBF,CAA2BG,CAAC,IAAI;IAC9B,IAAIT,IAAI,CAACS,CAAD,CAAR,EAAa;MACX,MAAMC,IAAI,GAAGX,SAAS,CAACU,CAAD,CAAtB;MACA,MAAME,OAAO,GAAGV,QAAQ,CAACW,GAATX,CAAaG,EAAbH,CAAhB;;MACA,IAAII,KAAK,CAACI,CAAD,CAALJ,IAAY,IAAhB,EAAsB;QACpBM,OAAO,EAAEH,OAATG,CAAiBE,CAAC,IAAI;UACpB,MAAM,CAACC,CAAD,EAAIC,EAAJ,IAAUF,CAAhB;;UACA,IAAIC,CAAC,KAAKJ,IAAV,EAAgB;YACdN,EAAE,CAACY,mBAAHZ,CAAuBM,IAAvBN,EAA6BW,EAA7BX;YACAO,OAAO,CAACM,MAARN,CAAeE,CAAfF;UACF;QACD,CANDA;MAOD,CARD,MAQO,IAAI,CAACA,OAAD,IAAY,CAAC,CAAC,GAAGA,OAAJ,GAAcO,IAAd,CAAmBL,CAAC,IAAIA,CAAC,CAAC,CAAD,CAADA,KAASH,IAATG,IAAiBA,CAAC,CAAC,CAAD,CAADA,KAASR,KAAK,CAACI,CAAD,CAAvD,CAAjB,EAA8E;QACnFL,EAAE,CAACe,gBAAHf,CAAoBM,IAApBN,EAA0BC,KAAK,CAACI,CAAD,CAA/BL;;QACA,MAAMgB,QAAQ,GAAGT,OAAO,IAAI,IAAIU,GAAJ,EAA5B;;QACAD,QAAQ,CAACE,GAATF,CAAa,CAACV,IAAD,EAAOL,KAAK,CAACI,CAAD,CAAZ,CAAbW;;QACA,IAAI,CAACnB,QAAQ,CAACsB,GAATtB,CAAaG,EAAbH,CAAL,EAAuBA,QAAQ,CAACuB,GAATvB,CAAaG,EAAbH,EAAiBmB,QAAjBnB;MACzB;IACD,CAjBD,MAiBO;MACL,IAAII,KAAK,CAACI,CAAD,CAALJ,IAAY,IAAhB,EAAsB;QACpBD,EAAE,CAACqB,eAAHrB,CAAmBK,CAAnBL;MACD,CAFD,MAEO;QACLA,EAAE,CAACsB,YAAHtB,CAAgBK,CAAhBL,EAAmBC,KAAK,CAACI,CAAD,CAAxBL;MACF;IACF;EACD,CAzBDE;AA0BF;AAEA,OAAO,SAASqB,WAAT,CAAsBvB,EAAtB,EAAuCC,KAAvC,EAAmE;EACxEC,MAAM,CAACC,IAAPD,CAAYD,KAAZC,EAAmBE,OAAnBF,CAA2BG,CAAC,IAAI;IAC9B,IAAIT,IAAI,CAACS,CAAD,CAAR,EAAa;MACX,MAAMC,IAAI,GAAGX,SAAS,CAACU,CAAD,CAAtB;MACA,MAAME,OAAO,GAAGV,QAAQ,CAACW,GAATX,CAAaG,EAAbH,CAAhB;MACAU,OAAO,EAAEH,OAATG,CAAiBE,CAAC,IAAI;QACpB,MAAM,CAACC,CAAD,EAAIC,EAAJ,IAAUF,CAAhB;;QACA,IAAIC,CAAC,KAAKJ,IAAV,EAAgB;UACdN,EAAE,CAACY,mBAAHZ,CAAuBM,IAAvBN,EAA6BW,EAA7BX;UACAO,OAAO,CAACM,MAARN,CAAeE,CAAfF;QACF;MACD,CANDA;IAOD,CAVD,MAUO;MACLP,EAAE,CAACqB,eAAHrB,CAAmBK,CAAnBL;IACF;EACD,CAdDE;AAeF","names":["eventName","isOn","handlers","WeakMap","bindProps","el","props","Object","keys","forEach","k","name","handler","get","v","n","fn","removeEventListener","delete","some","addEventListener","_handler","Set","add","has","set","removeAttribute","setAttribute","unbindProps"],"sources":["../../src/util/bindProps.ts"],"sourcesContent":["// Utilities\nimport { eventName, isOn } from '@/util/helpers'\n\nconst handlers = new WeakMap<HTMLElement, Set<[string, () => void]>>()\n\nexport function bindProps (el: HTMLElement, props: Record<string, any>) {\n  Object.keys(props).forEach(k => {\n    if (isOn(k)) {\n      const name = eventName(k)\n      const handler = handlers.get(el)\n      if (props[k] == null) {\n        handler?.forEach(v => {\n          const [n, fn] = v\n          if (n === name) {\n            el.removeEventListener(name, fn)\n            handler.delete(v)\n          }\n        })\n      } else if (!handler || ![...handler]?.some(v => v[0] === name && v[1] === props[k])) {\n        el.addEventListener(name, props[k])\n        const _handler = handler || new Set()\n        _handler.add([name, props[k]])\n        if (!handlers.has(el)) handlers.set(el, _handler)\n      }\n    } else {\n      if (props[k] == null) {\n        el.removeAttribute(k)\n      } else {\n        el.setAttribute(k, props[k])\n      }\n    }\n  })\n}\n\nexport function unbindProps (el: HTMLElement, props: Record<string, any>) {\n  Object.keys(props).forEach(k => {\n    if (isOn(k)) {\n      const name = eventName(k)\n      const handler = handlers.get(el)\n      handler?.forEach(v => {\n        const [n, fn] = v\n        if (n === name) {\n          el.removeEventListener(name, fn)\n          handler.delete(v)\n        }\n      })\n    } else {\n      el.removeAttribute(k)\n    }\n  })\n}\n"]},"metadata":{},"sourceType":"module"}